From Kenneth Sloan Subject Re Removing Distortion From Bitmapped Drawings In article Earl Boebert writes Let's say you have a scanned image of a line drawing in this case a boat but it could be On the drawing you have a set of reference points whose true x y positions are Now you digitize the drawing manually in this case using Yaron Danon's excellent Digitize program That is you use a program which converts cursor positions to x y and saves those values when you click the Upon digitizing you notice that the reference point values that come out of the digitizing process differ in small but significant ways from the known true This is understandable because the scanned drawing is a reproduction of the original and there are successive sources of distortion such as differential expansion and contraction of paper errors introduced in the printing process scanner errors and what have The errors are not uniform over the entire drawing so global adjustments such as stretching contracting uniformly over x or y or rotating the whole drawing are not So the question is does any kind soul know of an algorithm for removing such distortion In particular if I have three sets of points Reference x y the known true values DistortedReference x y the same points with known errors DistortedData x y other points with unknown errors what function of Reference and Distorted could I apply to DistortedData to remove the I suspect the problem could be solved by treating the distorted reference points as resulting from the projection of a bumpy surface solving for the surface and then flattening it to remove the errors in the other data It helps to have some idea of the source of the distortion or at least a reasonable model of the class of Below is a very short description of the process which we use if you have further questions feel free to poke me via e ASSUME locally smooth distortion Compute the Delaunay Triangulation of your x y This defines the set of neighbors for each If your data are not naturally convex you may have very long edges on the convex Consider deleting these Now there are two goals a move the DistortedData x y to the Reference x y b keep the Length e as measured from the current x y 's as close as possible to the DigitizedLength e as measured using the digitized x y 's For every point compute a displacement based on a and b For example a For x y points for which you know the Reference x y you can move Reference x y Current x y This will slowly move the DistortedReference x y towards the Reference x y b For all other points examine the current length of each For each edge compute a displacement which would make that edge the correct length where correct is the DigitizedLength Take the vector sum of these edge displacements and move the point This will keep the triangulated mesh consistent with your Digitized Iterate until you are happy for example no point moves very much and need to be determined by Consider how much you believe the Reference x y do you absolutely insist on the final points exactly matching the References or do you want to balance some error in matching the Reference against changes in length of the WARNING there are a couple of geometric invariants which must be observed essentially you can't allow the convex hull to change and you can't allow triangles to fold over neighboring Both of these can be handled either by special case checks on the motion of individual points or by periodically re triangulating the points using the current positions but still calculating DigitizedLength from the original When we first did this the triangulation time was prohibitive so we only did it If I were motivated to try and change code that has been working in production mode for years I might go back and re triangulate on every If you have more compute power than you know what to do with you might consider having every point interact with every other first read up on linear solutions to the n body There are lots of papers in the last years of SIGGRAPH proceedings on springs constraints and energy calculations which are The above method is described in more or less detail in inproceedings author Sloan Kenneth and David Meyers and Christine Curcio title Reconstruction and Display of the Retina booktitle Proceedings Graphics Interface ' Vision Interface ' address Vancouver Canada pages month May year techreport author Christine Curcio and Kenneth Sloan and David Meyers title Computer Methods for Sampling Reconstruction Display and Analysis of Retinal Whole Mounts number TR institution Department of Computer Science University of Washington address Seattle WA month December year article author Christine Curcio and Kenneth Sloan and David Meyers title Computer Methods for Sampling Reconstruction Display and Analysis of Retinal Whole Mounts journal Vision Research volume number pages year Kenneth Sloan Computer and Information Sciences University of Alabama at Birmingham Campbell Hall UAB Station FAX Birmingham AL