From david pop David E Smyth Subject Re R table widget causing trouble with XtQueryGeometry I just got a bug report and a fix for this exact problem from Greg Fisher the most serious problem I have identified has not been incorporated This problem occurs when the Table widget's GeometryManager is invoked by a child This will work correctly if the table widgets parent complies with the Xt protocols However, if they do not, as is the case for some Motif widgets, and they ignore XtCWQueryOnly, then the sizing will be incorrect In order to see this problem, the following events must happen A child of the table widget must request a new size The table widget must query its parent for a new size having set XtCWQueryOnly The parent must ignore the XtCWQueryOnly bit and resize the table widget As part of the resize, XmpTableForgetProposedLayout is called This will set tw table current cols and tw table current rows to zero The table will continue setting up the new size, working under the assumption that it is working with a proposed and not actual layout At the end, it will call XmpTableSaveProposedLayout This will save tw table cols and tw table rows and restore their values from tw table current cols and tw table current rows However, these have already been set to zero Since the table widget has already been resized, it will not need a second resize Next, another widget managed by some ancestor of the table is resized This results in the parent of the table requesting the tables preferred size Since tw table cols and tw table rows are zero, this will return x as the preferred size The parent is very likely to grant this request, resulting in a loss of the whole table from the display He isolated the problem a proposed a workaround which seems precisely correct Here is the new implementation of XmpTableNewProposedLayout which will be released with the next update in weeks Xmp Table c void XmpTableNewProposedLayout tw XmpTableWidget tw XmpTableConsiderSameSize tw XmpTableProposedColsAndRows tw XmpTableQueryParentForResize tw query only, no resize Since we only made a query, we should still need to continue However, Motif is broken so that we actually may already have been resized In that case, the proposed layout is already forgotten, so we should just quietly exit if tw table resize status RSdueToRequest XmpTableMakeColsFitQueryWidth tw XmpTableMakeRowsFitQueryHeight tw XmpTableGetProposedChildSize tw XmpTableSaveProposedLayout tw else the resize has already been done Our proposed layout would have been forgotten in the process The XpTable the fix is identical, except of course for the names Xp Table c void XpTableNewProposedLayout tw XpTableWidget tw XpTableConsiderSameSize tw XpTableProposedColsAndRows tw XpTableQueryParentForResize tw query only, no resize Since we only made a query, we should still need to continue However, some manager widgets are broken so that we actually may already have been resized In that case, the proposed layout is already forgotten, so we should just quietly exit if tw table resize status RSdueToRequest XpTableMakeColsFitQueryWidth tw XpTableMakeRowsFitQueryHeight tw XpTableGetProposedChildSize tw XpTableSaveProposedLayout tw else the resize has already been done Our proposed layout would have been forgotten in the process David Smyth Senior Software Engineer, do NOT use v mail yet CCCP, X and Object Guru office C Jet Propulsion Lab, M S Oak Grove Drive, Pasadena, CA That Sun Windows thingy, what's it called You know, its really awful X Motif That's it Motif Yuck