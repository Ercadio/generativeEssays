From Subject Cryptography FAQ Technical Miscellany Archive name cryptography faq Last modified FAQ for part Technical Miscellany This is the eighth of ten parts of the The parts are mostly independent but you should read the first part before the We don't have the time to send out missing parts by mail so don't Notes such as '' refer to the reference list in the last The sections of this FAQ are available via anonymous FTP to as pub usenet cryptography faq part xx The Cryptography FAQ is posted to the newsgroups and every Contents How do I recover from lost passwords in WordPerfect How do I break a Vigenere repeated key cipher How do I send encrypted mail under UNIX PGP RIPEM PEM Is the UNIX crypt command secure How do I use compression with encryption Is there an unbreakable cipher What does random'' mean in cryptography What is the unicity point unicity distance What is key management and why is it important Can I use pseudo random or chaotic numbers as a key stream What is the correct frequency list for English letters What is the Enigma How do I shuffle cards Can I foil S W pirates by encrypting my CD ROM Can you do automatic cryptanalysis of simple ciphers What is the coding system used by VCR How do I recover from lost passwords in WordPerfect WordPerfect encryption has been shown to be very easy to The method uses XOR with two repeating key streams a typed password and a byte wide counter initialized to the password length Full descriptions are given in Bennett and Bergen and Caelli Chris Galas writes Someone awhile back was looking for a way to decrypt WordPerfect document files and I think I have a There is a software company named Accessdata East South Orem UT that has a software package that will decrypt any WordPerfect Lotus Quatro Pro MS Excel and Paradox The cost of the package is Steep prices but if you think your pw key is less than characters or char give them a call and ask for the free demo The demo disk will decrypt files that have a char or less pw '' How do I break a Vigenere repeated key cipher A repeated key cipher where the ciphertext is something like the plaintext xor KEYKEYKEYKEY and so on is called a Vigenere If the key is not too long and the plaintext is in English do the following Discover the length of the key by counting See Gaines Sinkov Trying each displacement of the ciphertext against itself count those bytes which are If the two ciphertext portions have used the same key something over of the bytes will be If they have used different key then less than will be equal assuming random bit bytes of key covering normal ASCII text The smallest displacement which indicates an equal key is the length of the repeated Shift the text by that length and XOR it with This removes the key and leaves you with text XORed with Since English has about bit of real information per byte streams of text XORed together has bits of info per bit byte providing plenty of redundancy for choosing a unique And in fact one stream of text XORed with itself has just bit per If the key is short it might be even easier to treat this as a standard polyalphabetic All the old cryptanalysis texts show how to break It's possible with those methods in the hands of an expert if there's only ten times as much text as See for example Gaines Sinkov How do I send encrypted mail under UNIX PGP RIPEM PEM Here's one popular method using the des command cat file compress des private key uuencode mail Meanwhile there is a de jure Internet standard in the works called PEM Privacy Enhanced Mail It is described in RFCs through To join the PEM mailing list contact There is a beta version of PEM being tested at the time of this There are also two programs available in the public domain for encrypting mail PGP and Both are available by Each has its own newsgroup and Each has its own FAQ as PGP is most commonly used outside the USA since it uses the RSA algorithm without a license and RSA's patent is valid only or at least primarily in the RIPEM is most commonly used inside the USA since it uses the RSAREF which is freely available within the USA but not available for shipment outside the Since both programs use a secret key algorithm for encrypting the body of the message PGP used IDEA RIPEM uses DES and RSA for encrypting the message key they should be able to interoperate Although there have been repeated calls for each to understand the other's formats and algorithm choices no interoperation is available at this time as far as we know Is the UNIX crypt command secure See There is a program available called cbw crypt breaker's workbench which can be used to do ciphertext only attacks on files encrypted with One source for CBW is FTPCB How do I use compression with encryption A number of people have proposed doing perfect compression followed by some simple encryption method XOR with a repeated key Unfortunately you can only compress perfectly if you know the exact distribution of possible For all practical purposes it's impossible to describe the typical English text'' beyond coarse characteristics such as single letter You can build up more and more sophisticated models of your inputs but if the enemy has a slightly more accurate model he'll be able to find some redundancy in your compressed Note that nearly all practical compression schemes unless they have been designed with cryptography in mind produce output that actually starts off with high For example the output of UNIX compress begins with a well known three byte magic number'' that can serve as an entering wedge for This is not to say that compression before encryption is inherently a bad idea it just has to be done very very carefully and by no means removes the need for strong Compression after encryption is Is there an unbreakable cipher The one time pad is unbreakable see part Unfortunately the one time pad requires secure distribution of as much key material as Of course a cryptosystem need not be utterly unbreakable to be Rather it needs to be strong enough to resist attacks by likely enemies for whatever length of time the data it protects is expected to remain What does random'' mean in cryptography Cryptographic applications demand much more out of a pseudorandom number generator than most For a source of bits to be cryptographically random it must be computationally impossible to predict what the Nth random bit will be given complete knowledge of the algorithm or hardware generating the stream and the sequence of through N bits for all N up to the lifetime of the A software generator also known as pseudo random has the function of expanding a truly random seed to a longer string of apparently random This seed must be large enough not to be guessed by the Ideally it should also be truly random perhaps generated by a hardware random number source Those who have Sparcstation workstations could for example generate random numbers using the audio input device as a source of entropy by not connecting anything to For example cat dev audio compress foo gives a file of high entropy not random but with much randomness in it One can then encrypt that file using part of itself as a key for example to convert that seed entropy into a pseudo random When looking for hardware devices to provide this entropy it is important really to measure the entropy rather than just assume that because it looks complicated to a human it must be random For example disk operation completion times sound like they might be unpredictable to many people but a spinning disk is much like a clock and its output completion times are relatively low in What is the unicity point unicity distance See The unicity distance is an approximation to that amount of ciphertext such that the sum of the real information entropy in the corresponding source text and encryption key equals the number of ciphertext bits Ciphertexts significantly longer than this can be shown probably to have a unique This is used to back up a claim of the validity of a ciphertext only Ciphertexts significantly shorter than this are likely to have multiple equally valid decryptions and therefore to gain security from the opponent's difficulty choosing the correct Unicity distance like all statistical or information theoretic measures does not make deterministic predictions but rather gives probabilistic results namely the minimum amount of ciphertext for which it is likely that there is only a single intelligible plaintext corresponding to the ciphertext when all possible keys are tried for the Working cryptologists don't normally deal with unicity distance as Instead they directly determine the likelihood of events of Let the unicity distance of a cipher be D If fewer than D ciphertext characters have been intercepted then there is not enough information to distinguish the real key from a set of possible DES has a unicity distance of characters which is less than ciphertext blocks each block corresponds to ASCII characters This may seem alarmingly low at first but the unicity distance gives no indication of the computational work required to find the key after approximately D characters have been In fact actual cryptanalysis seldom proceeds along the lines used in discussing unicity Like other measures such as key size unicity distance is something that guarantees insecurity if it's too small but doesn't guarantee security if it's Few practical cryptosystems are absolutely impervious to analysis all manner of characteristics might serve as entering wedges'' to crack some cipher However similar information theoretic considerations are occasionally useful for example to determine a recommended key change interval for a particular Cryptanalysts also employ a variety of statistical and information theoretic tests to help guide the analysis in the most promising Unfortunately most literature on the application of information statistics to cryptanalysis remains classified even the seminal work of Alan Turing see For some insight into the possibilities see and What is key management and why is it important One of the fundamental axioms of cryptography is that the enemy is in full possession of the details of the general cryptographic system and lacks only the specific key data employed in the Of course one would assume that the CIA does not make a habit of telling Mossad about its cryptosystems but Mossad probably finds out Repeated use of a finite amount of key provides redundancy that can eventually facilitate cryptanalytic Thus especially in modern communication systems where vast amounts of information are transferred both parties must have not only a sound cryptosystem but also enough key material to cover the Key management refers to the distribution authentication and handling of A publicly accessible example of modern key management technology is the STU III secure telephone unit which for classified use employs individual coded Crypto Ignition Keys'' and a central Key Management Center operated by There is a hierarchy in that certain CIKs are used by authorized cryptographic control personnel to validate the issuance of individual traffic keys and to perform installation maintenance functions such as the reporting of lost This should give an inkling of the extent of the key management For public key systems there are several related issues many having to do with whom do you trust '' Can I use pseudo random or chaotic numbers as a key stream Chaotic equations and fractals produce an apparent randomness from relatively compact Perhaps the simplest example is a linear congruential sequence one of the most popular types of random number generators where there is no obvious dependence between seeds and Unfortunately the graph of any such sequence will in a high enough dimension show up as a regular Mathematically this lattice corresponds to structure which is notoriously easy for cryptanalysts to More complicated generators have more complicated structure which is why they make interesting pictures but a cryptographically strong sequence will have no computable structure at See exercise and What is the correct frequency list for English letters There are three answers to this question each slightly deeper than the one You can find the first answer in various books namely a frequency list computed directly from a certain sample of English Of course any such list will be correctly'' computed but exactly which list you get depends on which sample was The second answer is that the question doesn't make What do you mean by English letters'' The English language'' is not a fixed finite closed object that can be exactly It has changed over time it is different between different Any particular message will have different statistics from those of the language as a The third answer is that yes no particular message is going to have exactly the same characteristics as English in general but for all reasonable statistical uses these slight discrepancies won't In fact there's an entire field called Bayesian statistics'' other buzzwords are maximum entropy methods'' and maximum likelihood estimation'' which studies questions like What's the chance that a text with these letter frequencies is in English '' and comes up with reasonably robust So make your own list from your own samples of English It will be good enough for practical work if you use it What is the Enigma For a project in data security we are looking for sources of information about the German Enigma code and how it was broken by the British during '' See How do I shuffle cards Card shuffling is a special case of the permutation of an array of values using a random or pseudo random All possible output permutations of this process should be equally To do this you need a random function modran x which will produce a uniformly distributed random integer in the interval Given that function you can shuffle with the following C code assuming ARRLTH is the length of array arr and swap interchanges values at the two addresses given for n ARRLTH n n swap arr modran n arr n modran x can not be achieved exactly with a simple ranno x since ranno 's interval may not be divisible by x although in most cases the error will be very To cover this case one can take ranno 's modulus mod x call that number y and if ranno returns a value less than y go back and get another ranno Can I foil S W pirates by encrypting my CD ROM Someone will frequently express the desire to publish a CD ROM with possibly multiple pieces of software perhaps with each encrypted separately and will want to use different keys for each user perhaps even good for only a limited period of time in order to avoid As far as we know this is impossible since there is nothing in standard PC or workstation hardware which uniquely identifies the user at the If there were such an identification then the CD ROM could be encrypted with a key based in part on the one sold to the user and in part on the unique However in this case the CD ROM is one of a kind and that defeats the intended If the CD ROM is to be encrypted once and then mass produced there must be a key or set of keys for that encryption produced at some stage in the That key is useable with any copy of the CD ROM's The pirate needs only to isolate that key and sell it along with the illegal Can you do automatic cryptanalysis of simple ciphers Bruce Schneier says AccessData of Orem Utah sells products that break the password scheme of a number of popular Macintosh and PC software Their telephone number is No PD software has been cited but there are many papers on the Peleg and Rosenfeld Breaking Substitution Ciphers Using a Relaxation Algorithm ACM pp Lucks Michael A Constraint Satisfaction Algorithm for the Automated Decryption of Simple Substitution Ciphers Advances in Cryptology CRYPTO ' Springer Lecture Notes in Computer Science The paper also contains references to earlier work on the John Carrol and Steve Martin The Automated Cryptanalysis of Substitution Ciphers Cryptologia vol X number Oct John Carrol and Lynda Robbins Automated Cryptanalysis of Polyalphabetic Ciphers Cryptologia vol XI number Oct Martin Kochanski A Survey of Data Insecurity Packages Cryptologia vol XI number Jan Martin Kochanski Another Data Insecurity Package Cryptologia vol XII number July Cryptologia Vol XIII Number pp King and Bahler Probabilistic Relaxation in the Cryptanalysis of Simple Substitution Ciphers Cryptologia King and Bahler An Algorithmic Solution of Sequential Homophonic Ciphers Cryptologia April in press Spillman Use of Genetic Algorithms in Cryptanalysis of Simple Substitution Ciphers Cryptologia vol XVII Number Jan What is the coding system used by VCR One very frequently asked question in is about how the VCR codes The following article attempts to describe Shirriff Welch Kinsman Decoding a VCR Controller Code Cryptologia July pp