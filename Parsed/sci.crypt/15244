From Subject Cryptography FAQ Mathematical Cryptology Archive name cryptography faq Last modified FAQ for part Mathematical Cryptology This is the fourth of ten parts of the The parts are mostly independent but you should read the first part before the We don't have the time to send out missing parts by mail so don't Notes such as '' refer to the reference list in the last The sections of this FAQ are available via anonymous FTP to as pub usenet cryptography faq part xx The Cryptography FAQ is posted to the newsgroups and every Contents In mathematical terms what is a private key cryptosystem What is an attack What's the advantage of formulating all this mathematically Why is the one time pad secure What's a ciphertext only attack What's a known plaintext attack What's a chosen plaintext attack In mathematical terms what can you say about brute force attacks What's a key guessing attack What's entropy In mathematical terms what is a private key cryptosystem A private key cryptosystem consists of an encryption system E and a decryption system The encryption system E is a collection of functions E K indexed by keys'' K mapping some set of plaintexts'' P to some set of ciphertexts'' Similarly the decryption system D is a collection of functions D K such that D K E K P P for every plaintext That is succesful decryption of ciphertext into plaintext is accomplished using the same key index as was used for the corresponding encryption of plaintext into Such systems wherein the same key value is used to encrypt and decrypt are also known as symmetric'' What is an attack In intuitive terms a passive attack on a cryptosystem is any method of starting with some information about plaintexts and their corresponding ciphertexts under some unknown key and figuring out more information about the It's possible to state mathematically what this Here we Fix functions F G and H of n Fix an encryption system E and fix a distribution of plaintexts and An attack on E using G assuming F giving H with probability p is an algorithm A with a pair f g of inputs and one output h such that there is probability p of computing h H P P n if we have f F P P n and g G E K P E K P n Note that this probability depends on the distribution of the vector K P P n The attack is trivial or pointless'' if there is probability at least p of computing h H P P n if f F P P n and g G C C n Here C C n range uniformly over the possible ciphertexts and have no particular relation to P P In other words an attack is trivial if it doesn't actually use the encryptions E K P E K P n An attack is called one ciphertext'' if n two ciphertext'' if n and so What's the advantage of formulating all this mathematically In basic cryptology you can never prove that a cryptosystem is Read part we keep saying a strong cryptosystem must have this property but having this property is no guarantee that a cryptosystem is strong '' In contrast the purpose of mathematical cryptology is to precisely formulate and if possible prove the statement that a cryptosystem is We say for example that a cryptosystem is secure against all passive attacks if any nontrivial attack against the system as defined above is too slow to be If we can prove this statement then we have confidence that our cryptosystem will resist any passive cryptanalytic If we can reduce this statement to some well known unsolved problem then we still have confidence that the cryptosystem isn't easy to Other parts of cryptology are also amenable to mathematical Again the point is to explicitly identify what assumptions we're making and prove that they produce the desired We can figure out what it means for a particular cryptosystem to be used properly it just means that the assumptions are The same methodology is useful for cryptanalysis The cryptanalyst can take advantage of incorrect Often he can try to construct a proof of security for a system see where the proof fails and use these failures as the starting points for his Why is the one time pad secure By definition the one time pad is a cryptosystem where the plaintexts ciphertexts and keys are all strings say byte strings of some length m and E K P is just the sum let's say the exclusive or of K and It is easy to prove mathematically that there are no nontrivial single ciphertext attacks on the one time pad assuming a uniform distribution of Note that we don't have to assume a uniform distribution of Here's the proof Let A be an attack an algorithm taking two inputs f g and producing one output h with some probability p that h H P whenever f F P and g G E K P g G K P Then because the distribution of K is uniform and independent of P the distribution of K P must also be uniform and independent of But also the distribution of C is uniform and independent of Hence there is probability exactly p that h H P whenever f F P and g G C over all P and Thus a fortiori A is On the other hand the one time pad is not secure if a key K is used for more than one plaintext there are nontrivial multiple ciphertext So to be properly used a key K must be thrown away after one The key is also called a pad'' this explains the name one time '' What's a ciphertext only attack In the notation above a ciphertext only attack is one where F is Given only some information G E K P E K P n about n ciphertexts the attack has to have some chance of producing some information H P P n about the The attack is trivial if it has just as good a chance of producing H P P n when given G C C n for random C C For example say G C C and say H P is the first bit of We can easily write down an attack the guessing attack '' which simply guesses that H P is This attack is trivial because it doesn't use the ciphertext it has a fifty fifty chance of guessing correctly no matter On the other hand there is an attack on RSA which produces one bit of information about P with success using If it is fed a random C then the success rate drops to So this is a nontrivial What's a known plaintext attack The classic known plaintext attack has F P P P G C C C C and H P P depending only on P In other words given two ciphertexts C and C and one decryption P the known plaintext attack should produce information about the other decryption P Note that known plaintext attacks are often defined in the literature as producing information about the key but this is pointless the cryptanalyst generally cares about the key only insofar as it lets him decrypt further What's a chosen plaintext attack A chosen plaintext attack is the first of an increasingly impractical series of active attacks on a cryptosystem attacks where the cryptanalyst feeds data to the These attacks don't fit into our model of passive attacks explained Anyway a chosen plaintext attack lets the cryptanalyst choose a plaintext and look at the corresponding ciphertext then repeat until he has figured out how to decrypt any More absurd examples of this sort of attack are the chosen key attack'' and chosen system '' A much more important form of active attack is a message corruption attack where the attacker tries to change the ciphertext in such a way as to make a useful change in the There are many easy ways to throw kinks into all of these attacks for instance automatically encrypting any plaintext P as T E K h T R P R P where T is a time key sequence number chosen anew for each message R is a random number and h is a one way hash Here comma means concatenation and plus means exclusive In mathematical terms what can you say about brute force attacks Consider the following known plaintext We are given some plaintexts P P n and ciphertexts C C n We're also given a ciphertext C We run through every key When we find K such that E K P i C i for every i n we print D K C n If n is big enough that only one key works this attack will succeed on valid inputs all the time while it will produce correct results only once in a blue moon for random Thus this is a nontrivial Its only problem is that it is very slow if there are many possible What's a key guessing attack What's entropy Say somebody is using the one time pad but isn't choosing keys randomly and uniformly from all m bit messages as he was supposed to for our security In fact say he's known to prefer keys which are English Then a cryptanalyst can run through all English words as possible This attack will often succeed and it's much faster than a brute force search of the entire We can measure how bad a key distribution is by calculating its This number E is the number of real bits of information'' of the key a cryptanalyst will typically happen across the key within E E is defined as the sum of p K log p K where p K is the probability of key