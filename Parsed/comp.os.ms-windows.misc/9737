From gordon hlavenka Subject Re Save my hard disk allocation error cross linked Brad Banko writes While running the MS Quick C compiler in a DOS window under Windows this evening I got a program has violated system close all applications exit windows and restart your computer Gawd I love Windows Is there an easy way to restore everything to working order What might be some better approaches You'll probably want to delete any damaged executables and reload them Data files should be examined and What might have caused this Does the SMARTDRV cache make me more vulnerable I'm suspicious of hard drive caches especially when they cache data You're not Smartdrive caches things and Windows also runs a swap file which may contain data All of this is pretty risky stuff in a PC The straightforward approach would be to run chkdsk with the f option to fix the disk and then it looks like I would probably have to reinstall Windows and a few other A reasonably accurate Here's a brief description of how DOS stores files There are three pieces to a The directory entry the FAT chain and the data You can think of these as a sheet of lined notebook paper a sheet of graph paper and a stack of The directory entry notebook paper holds the file name actual size and first cluster It also holds some other information that's not important right The File Allocation Table FAT chain graph paper tells where to find the actual Each square of graph paper holds a If the number is zero the cluster associated with this box is If it holds a magic number it is either the last piece of a file or a bad unuseable spot on the Any other number tells which cluster contains the next section of the The data area cards is where the actual information is The data area is organized as clusters of a fixed size storage is doled out in chunks of one cluster In your case one cluster is As a cluster is filled another is To read a file you first look at the directory entry to get the starting cluster Now you read the data from that Next look at the FAT entry for the cluster you just This will tell you the cluster number for the next chunk of the Naturally these numbers are usually sequential but they can jump around and even go Continue reading one cluster at a time as you walk this chain through the FAT until you hit the marker which says it's the last cluster in the CHKDSK is the DOS utility that checks the sanity and coherence of the directories and the FAT and can bludgeon most flaws into It doesn't have any intelligence so you have to double check anything it fixes Now let's do a bit of a post mortem C GFX C GFX C GFX C GFX C GFX C GAME GOOSE C WINMISC Allocation error size adjusted All of these files have sizes according to the FAT which don't match the size reported in their directory CHKDSK F will alter the directory entries to match the FAT In other words the directory entry for may say the file is bytes But CHKDSK found a FAT chain of clusters attached to My numbers obviously are made lost allocation units found in bytes disk space would be freed Disk space was found which is allocated in the FAT but is not attached to any directory CHKDSK F gives you the option of converting these lost chains to You can then examine the files through and rename or discard Or if you tell CHKDSK not to convert them to files then those clusters will simply be marked available in the C GFX Is cross linked on allocation unit C Is cross linked on allocation unit These files are both referencing the same data Obviously one of them at least must be It's interesting to note that C is your Windows swap To fix this you should copy each cross linked file to a new This will fix the cross link by giving the files unique data Now delete the cross linked Examine the copies and try to assemble them Good Hint Missing pieces are likely to be found in those lost chains at the bytes total disk space bytes in hidden files bytes in directories bytes in user files bytes available on disk Your disk is pretty close to This may be the actual cause of the problem perhaps Windows needed to expand its swapfile by an amount which exceeded available disk In any case the short summary is that something trashed your There are utilities that can mirror your FAT and help repair damage after something like this but you have to run them before the problem Gordon Hlavenka Vote straight ticket Procrastination party Gordon Hlavenka Vote straight ticket Procrastination party